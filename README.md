# Building a Digital Twin for Network Optimization using Graph Neural Networks
#### Miquel Ferriol-Galmés, José Suárez-Varela, Jordi Paillissé, Bo Wu, Shihan Xiao, Xiangle Cheng, Pere Barlet-Ros and Albert Cabellos-Aparicio

### Abstract
Network modeling is a critical component of Quality of Service (QoS) optimization. Current networks implement Service Level Agreements (SLA) by careful configuration of both routing and queue scheduling policies. However, existing modeling techniques are not able to produce accurate estimates of relevant SLA metrics, such as delay or jitter, in networks with complex QoS-aware queueing policies (e.g., strict priority, Weighted Fair Queueing, Deficit Round Robin). Recently, Graph Neural Networks (GNNs) have become a powerful tool to model networks since they are specifically designed to work with graph-structured data. In this paper, we propose a GNN-based network model able to understand the complex relationship between _(i)_ the queueing policy (scheduling algorithm and queue sizes), _(ii)_ the network topology, _(iii)_ the routing configuration, and _(iv)_ the input traffic matrix. We call our model TwinNet, a _Digital Twin_ that can accurately estimate relevant SLA metrics for network optimization. TwinNet can generalize to its input parameters, operating successfully in topologies, routing, and queueing configurations never seen during training. We evaluate TwinNet over a wide variety of scenarios with synthetic traffic and validate it with real traffic traces. Our results show that TwinNet can provide accurate estimates of end-to-end path delays in 106 unseen real-world topologies, under different queuing configurations with a Mean Absolute Percentage Error (MAPE) of 3.8%, as well as a MAPE of 6.3% error when evaluated with a real testbed. We also showcase the potential of the proposed model for SLA-driven network optimization and what-if analysis.

### Reproducibility
All  the datasets used for this paper can be found at:
## [Datasets](https://github.com/BNN-UPC/NetworkModelingDatasets/tree/master/datasets_v4)
